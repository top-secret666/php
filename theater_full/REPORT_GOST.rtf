{\rtf1\ansi\ansicpg65001\deff0
{\fonttbl{\f0 Times New Roman;}}
\paperw11906\paperh16838\margl1701\margr850\margt1134\margb1134
\fs28\sl360\slmult1\qj

\pard\qc\fs28
(Наименование образовательной организации)\par
(Факультет/кафедра)\par
\par
\pard\qc\fs32\b
ОТЧЕТ\par
по проекту «Театральная касса»\par
\b0\fs28
\par
Дисциплина: (указать)\par
Тема: Разработка веб‑приложения «Театральная касса» на Laravel\par
\par
\pard\qr
Выполнил: (ФИО, группа)\par
Проверил: (ФИО преподавателя)\par
\par
\pard\qc
Город: (указать)\par
2026\par

\page
\pard\qc\fs32\b СОДЕРЖАНИЕ\b0\fs28\par
\par
1. Введение\par
2. Анализ предметной области\par
3. Проектирование базы данных (ER‑диаграмма)\par
4. Описание архитектуры приложения\par
5. Реализация основных компонентов\par
   5.1. Модели и отношения\par
   5.2. Контроллеры и маршруты\par
   5.3. Представления и формы\par
   5.4. Валидация данных\par
   5.5. Аутентификация и авторизация\par
6. Алгоритмы и бизнес‑логика\par
7. Скриншоты работы приложения\par
8. Листинг ключевых фрагментов кода\par
9. Тестирование и результаты\par
10. CI/CD и автоматизация\par
11. Заключение\par
12. Список литературы\par
\par
\pard\qj\fs24
Примечание по ГОСТ: оглавление в Word рекомендуется сформировать автоматически (Ссылки → Оглавление) после назначения стилей заголовков. Нумерация страниц: титульный лист учитывается, но номер не ставится; нумерация начинается со страницы «Введение».\par

\page
\pard\qc\fs32\b ВВЕДЕНИЕ\b0\fs28\par
\pard\qj\fi709
Актуальность. Театральные организации нуждаются в цифровых системах бронирования и продажи билетов с учетом схемы зала, ценовых уровней и расписания показов. Веб‑приложение позволяет снизить операционные затраты, повысить прозрачность учета, улучшить пользовательский опыт за счет онлайн‑покупки, а также обеспечить контроль доступа и безопасную обработку данных.\par
\par
Цель работы — спроектировать и реализовать веб‑приложение «Театральная касса» на Laravel (PHP 8.2), поддерживающее управление репертуаром, расписанием, билетами и заказами, с загрузкой файлов (постеров), валидацией, аутентификацией, ролью администратора и статистикой посещаемости/продаж.\par
\par
Задачи работы:\par
\pard\qj\fi709
1) Проанализировать предметную область (постановки, сеансы, места, цены, заказы, билеты).\par
2) Спроектировать структуру базы данных (ER‑модель и реляционная схема).\par
3) Реализовать сущности и связи в Laravel (модели, миграции, связи Eloquent).\par
4) Реализовать пользовательские сценарии (афиша, покупка билета, заказы, корзина).\par
5) Реализовать серверную валидацию (FormRequest).\par
6) Реализовать аутентификацию и авторизацию (RBAC: админ/пользователь).\par
7) Реализовать загрузку файлов (постер спектакля) и корректную раздачу файлов в web‑части.\par
8) Подготовить набор функциональных тестов и CI для воспроизводимых проверок.\par
\par
Объект исследования: процессы продажи и учета билетов в театре.\par
Предмет исследования: программные методы автоматизации учета показов, мест и билетов.\par
Методы: анализ, проектирование БД, моделирование, реализация MVC, тестирование.\par

\page
\pard\qc\fs32\b АНАЛИЗ ПРЕДМЕТНОЙ ОБЛАСТИ\b0\fs28\par
\pard\qj\fi709
Театральная касса — система, которая поддерживает полный цикл работы с показами и билетами: формирование репертуара, расписания, управление ценами, бронирование/продажу, оформление заказов и проверку билетов на входе.\par
\par
Основные сущности:\par
\pard\qj\fi709
• Площадки (venues) — театры/залы, адрес и вместимость.\par
• Постановки (shows) — спектакли с описанием, длительностью, языком, возрастным рейтингом и постером.\par
• Сеансы (performances) — конкретные показы спектаклей (дата/время, статус).\par
• Секции/места (seat_sections, seats) — схема зала: секции, ряды, номера, типы мест.\par
• Ценовые уровни (price_tiers) — стоимость билетов (в центах), привязка к площадке/постановке/секции.\par
• Заказы (orders) — покупка набора билетов пользователем.\par
• Билеты (tickets) — пара «сеанс–место», статус, цена, QR‑код, отметки времени выдачи/прохода.\par
• Платежи (payments) — учет транзакций (в учебной версии предусмотрено в модели данных, интеграция упрощена).\par
\par
Типовые сценарии использования:\par
\pard\qj\fi709
1) Просмотр афиши: гость видит список постановок, выполняет поиск, фильтрацию и сортировку, переходит в карточку спектакля.\par
2) Выбор сеанса: пользователь выбирает дату/время сеанса в расписании.\par
3) Бронирование: создается билет со статусом reserved.\par
4) Корзина: пользователь просматривает свои брони и оформляет заказ.\par
5) Оформление заказа: билеты привязываются к заказу и переводятся в sold, формируется QR‑код.\par
6) Check‑in: администратор/контролер отмечает билет при проходе.\par
\par
Нефункциональные требования:\par
\pard\qj\fi709
• Надежность: исключение двойной продажи места (уникальность performance_id + seat_id).\par
• Производительность: пагинация списков, индексирование внешних ключей.\par
• Безопасность: CSRF‑защита форм, серверная валидация, разграничение доступа.\par
• Сопровождаемость: единый слой валидации (FormRequest), тесты ключевых сценариев.\par

\page
\pard\qc\fs32\b ПРОЕКТИРОВАНИЕ БАЗЫ ДАННЫХ (ER‑ДИАГРАММА)\b0\fs28\par
\pard\qj\fi709
ER‑диаграммы подготовлены в файлах drawio: theater_er_chen_conceptual.drawio, theater_er_chen_relational.drawio, theater_uml_class.drawio. Для Word‑версии требуется вставить экспортированные изображения (PNG/PDF).\par
\par
Ключевые связи:\par
\pard\qj\fi709
• venues 1..* shows\par
• shows 1..* performances\par
• seat_sections 1..* seats\par
• performances 1..* tickets\par
• orders 1..* tickets\par
\par
Словарь данных (фрагмент):\par
\pard\qj\fi709
venues(id, name, address, capacity)\par
shows(id, venue_id, title, description, director, duration_minutes, language, age_rating, poster_url)\par
performances(id, show_id, starts_at, status)\par
tickets(id, performance_id, seat_id, order_id, purchaser_id, price, status, qr_code, issued_at, checked_in_at)\par
orders(id, user_id, total_amount, status)\par
price_tiers(id, venue_id?, show_id?, section_id?, amount_cents, currency)\par
\par
Статистика по сеансам: используется таблица performance_stats (tickets_sold, checked_in_count, revenue) для отчетности по посещаемости и продажам.\par
\par
[ВСТАВИТЬ РИСУНОК 1 — ER‑диаграмма (концептуальная)]\par
[ВСТАВИТЬ РИСУНОК 2 — ER‑диаграмма (реляционная)]\par

\page
\pard\qc\fs32\b ОПИСАНИЕ АРХИТЕКТУРЫ ПРИЛОЖЕНИЯ\b0\fs28\par
\pard\qj\fi709
Приложение разработано на Laravel 12.x и следует архитектуре MVC:\par
• Model — Eloquent‑модели, отражающие сущности предметной области.\par
• View — Blade‑шаблоны интерфейса (страницы списков, форм, карточек).\par
• Controller — ресурсные контроллеры для CRUD и бизнес‑операций (покупка/checkout).\par
\par
Слои приложения:\par
\pard\qj\fi709
1) Маршрутизация (routes/web.php): REST‑маршруты для сущностей + дополнительные маршруты (поиск, корзина, статистика).\par
2) Валидация: FormRequest классы (StoreShowRequest, StoreOrderRequest, StoreTicketRequest и др.).\par
3) Бизнес‑логика: обработка покупки/резервирования, генерация QR‑кода, обновление performance_stats (выделено в сервис).\par
4) Авторизация: auth middleware + AdminMiddleware, а также проверки владения данными в контроллерах.\par
5) Представление: layout и частичные шаблоны (navbar, карточки, кнопки действий по роли).\par
\par
Развертывание: веб‑сервер + PHP 8.2, БД (в тестах SQLite), фронтенд на Blade/CSS.\par

\page
\pard\qc\fs32\b РЕАЛИЗАЦИЯ ОСНОВНЫХ КОМПОНЕНТОВ\b0\fs28\par
\pard\qc\fs30\b 5.1. Модели и отношения\b0\fs28\par
\pard\qj\fi709
Ключевые модели: Show, Performance, Ticket, Order, Seat, SeatSection, Venue, PriceTier, Payment, User.\par
Примеры отношений:\par
\pard\qj\fi709
• Show belongsTo Venue\par
• Performance belongsTo Show\par
• Ticket belongsTo Performance, Seat, Order; и purchaser (User)\par
• Order belongsTo User; hasMany Tickets\par
\par
\pard\qc\fs30\b 5.2. Контроллеры и маршруты\b0\fs28\par
\pard\qj\fi709
Реализованы resource‑контроллеры: ShowController, ActorController, PerformanceController, TicketController, OrderController.\par
Дополнительно: CartController (корзина/checkout), Admin\StatsController (статистика).\par
Маршруты: Route::resource(...) + /shows/search + /cart + /admin/stats.\par
\par
\pard\qc\fs30\b 5.3. Представления и формы\b0\fs28\par
\pard\qj\fi709
Интерфейс реализован на Blade. Используется единый layout (resources/views/layouts/app.blade.php), частичные шаблоны (navbar) и страницы CRUD для сущностей.\par
На страницах отображаются действия в зависимости от роли (админ видит кнопки редактирования/удаления; пользователь — покупку/корзину/свои заказы).\par
\par
\pard\qc\fs30\b 5.4. Валидация данных\b0\fs28\par
\pard\qj\fi709
Серверная валидация реализована через FormRequest. Пример для заказа: user_id может быть nullable (для пользователя назначается в контроллере), total_amount обязателен и неотрицателен.\par
\par
\pard\qc\fs30\b 5.5. Аутентификация и авторизация\b0\fs28\par
\pard\qj\fi709
Аутентификация: login/register/logout. Авторизация: auth middleware + AdminMiddleware.\par
RBAC: администратор управляет сущностями и статистикой; пользователь работает только со своей корзиной и заказами.\par

\page
\pard\qc\fs32\b АЛГОРИТМЫ И БИЗНЕС‑ЛОГИКА\b0\fs28\par
\pard\qj\fi709
1) Резервирование билета: создается ticket со статусом reserved, уникальность пары performance_id+seat_id предотвращает двойную продажу.\par
2) Покупка: создается order, билет привязывается к order_id, статус становится sold, генерируется QR‑код.\par
3) Корзина/checkout: пользователь собирает reserved‑билеты, затем одним действием оформляет заказ, переводя все билеты в sold.\par
4) Check‑in: для билета устанавливается checked_in_at; статистика обновляется.\par
\par
Обработка цен: amount_cents хранится в price_tiers; при создании/обновлении билета цена вычисляется как amount_cents/100.\par
Обновление статистики: при изменении статуса/checked_in_at обновляются поля performance_stats; логика вынесена в сервис PerformanceStatsUpdater.\par

\page
\pard\qc\fs32\b СКРИНШОТЫ РАБОТЫ ПРИЛОЖЕНИЯ\b0\fs28\par
\pard\qj\fi709
В Word‑версии отчета необходимо вставить скриншоты с подписями вида «Рисунок N — …».\par
Рекомендуемый набор:\par
\pard\qj\fi709
• Главная страница (афиша) со списком постановок и постерами.\par
• Карточка постановки и расписание.\par
• Страница покупки/создания билета.\par
• Корзина (список reserved‑билетов и итог).\par
• «Мои заказы» (пользователь) и просмотр заказа.\par
• Админ‑страницы: управление постановками/сеансами и страница статистики.\par
\par
[ВСТАВИТЬ РИСУНОК 3 — Афиша]\par
[ВСТАВИТЬ РИСУНОК 4 — Корзина]\par
[ВСТАВИТЬ РИСУНОК 5 — Статистика (админ)]\par

\page
\pard\qc\fs32\b ЛИСТИНГ КЛЮЧЕВЫХ ФРАГМЕНТОВ КОДА\b0\fs28\par
\pard\qj\fi709
Ниже приводятся ключевые фрагменты, демонстрирующие бизнес‑логику. В Word рекомендуется оформить листинги моноширинным шрифтом (например, Courier New 10–12), с нумерацией строк при необходимости.\par
\par
1) Генерация QR‑кода при продаже билета:\par
\pard\qj\fi709\fs22
if (isset($data['status']) && $data['status'] === 'sold' && empty($data['qr_code'])) {\par
    $data['qr_code'] = bin2hex(random_bytes(8));\par
}\par
\fs28
\par
2) Привязка цены к ценовому уровню:\par
\pard\qj\fi709\fs22
$tier = PriceTier::find($data['price_tier_id']);\par
$data['price'] = $tier->amount_cents / 100;\par
\fs28
\par
3) Пример проверки доступа (админ‑middleware):\par
\pard\qj\fi709\fs22
if (!$user || !$user->is_admin) {\par
    abort(403);\par
}\par
\fs28

\page
\pard\qc\fs32\b ТЕСТИРОВАНИЕ И РЕЗУЛЬТАТЫ\b0\fs28\par
\pard\qj\fi709
Тестирование выполнено функциональными (Feature) тестами с использованием RefreshDatabase и фабрик данных.\par
Проверяемые сценарии включают: регистрацию/логин, CRUD (админ), поиск/фильтрацию/сортировку и пагинацию, загрузку постера, покупку/оформление заказа, генерацию QR‑кода, check‑in, а также корректность разграничения доступа (админ/пользователь).\par
\par
Результат прогона: 53 теста, 133 утверждения — успешно.\par

\page
\pard\qc\fs32\b CI/CD И АВТОМАТИЗАЦИЯ\b0\fs28\par
\pard\qj\fi709
Используется GitHub Actions (workflow .github/workflows/ci.yml). В CI выполняются: установка зависимостей, подготовка окружения, генерация ключа приложения, миграции с seed, запуск тестов.\par
Это обеспечивает воспроизводимость и гарантирует, что проект собирается и проходит тесты в «чистой» среде.\par

\page
\pard\qc\fs32\b ЗАКЛЮЧЕНИЕ\b0\fs28\par
\pard\qj\fi709
В ходе работы разработано веб‑приложение «Театральная касса» на Laravel 12.x (PHP 8.2), включающее проектирование БД, реализацию сущностей и связей, CRUD‑операции, валидацию данных, аутентификацию и авторизацию с разграничением ролей, загрузку файлов (постеры), механизм корзины и страницу статистики посещаемости/продаж.\par
\par
Практическая значимость заключается в автоматизации процессов бронирования и продажи билетов, упрощении учета и обеспечении доступности сервиса для пользователей.\par
\par
Перспективы развития: интеграция с платежными провайдерами, электронные билеты (PDF), интерактивная схема зала, расширенная аналитика и отчеты.\par

\page
\pard\qc\fs32\b СПИСОК ЛИТЕРАТУРЫ\b0\fs28\par
\pard\qj\fi709
1. Laravel Documentation. URL: https://laravel.com/docs (дата обращения: 23.01.2026).\par
2. PHP Manual. URL: https://www.php.net/docs.php (дата обращения: 23.01.2026).\par
3. PHPUnit Documentation. URL: https://phpunit.de/documentation.html (дата обращения: 23.01.2026).\par
4. diagrams.net (draw.io) — инструмент для ER‑диаграмм. URL: https://www.diagrams.net/ (дата обращения: 23.01.2026).\par
5. Date C.J. An Introduction to Database Systems. (общая теория БД).\par

\par
\pard\qj\fs24
Примечание по оформлению ГОСТ: основной текст — Times New Roman 14, межстрочный интервал 1,5, абзацный отступ 1,25 см, выравнивание по ширине; поля: левое 3 см, правое 1,5 см, верх/низ 2 см. Заголовки — полужирные, без точки в конце; рисунки и таблицы нумеруются и имеют подписи.\par
}
